% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/annotate_with_rowdata_peaks.R
\name{annotate_with_rowdata_peaks}
\alias{annotate_with_rowdata_peaks}
\title{Annotate a tibble with peak coordinates from a SummarizedExperiment}
\usage{
annotate_with_rowdata_peaks(
  df,
  se,
  key_col = "peak_id",
  seq_field = "seqnames",
  start_field = "start",
  end_field = "end",
  warn_unmatched = TRUE
)
}
\arguments{
\item{df}{A data.frame or tibble to annotate (target table).}

\item{se}{A \code{SummarizedExperiment} whose \code{rowData} contains
\code{seqnames}, \code{start}, and \code{end}; \code{rownames(se)} must be
the peak identifiers to match.}

\item{key_col}{Character scalar. Column in \code{df} that contains peak IDs
matching \code{rownames(se)}. Default \code{"peak_id"}.}

\item{seq_field, start_field, end_field}{Character scalars naming the columns
in \code{rowData(se)} to use. Defaults: \code{"seqnames"}, \code{"start"}, \code{"end"}.}

\item{warn_unmatched}{Logical; warn if some keys in \code{df} do not match any
\code{rownames(se)}. Default \code{TRUE}.}
}
\value{
\code{df} with added columns: \code{peak_id}, \code{peak_chr},
\code{peak_start}, \code{peak_end}.
}
\description{
Left-joins \code{df} to \code{rowData(se)} by matching \code{df[[key_col]]}
to \code{rownames(se)}. Appends four columns to \code{df}:
\code{peak_id} (the matched key), \code{peak_chr} (from \code{seqnames}),
\code{peak_start} (from \code{start}), and \code{peak_end} (from \code{end}).
The number and order of rows in \code{df} are preserved.
}
\examples{
\dontrun{
# df has "peak_ID" that matches rownames(se_atac_full)
df2 <- annotate_with_rowdata_peaks(
  df = df,
  se = se_atac_full,
  key_col = "peak_ID"  # becomes df2$peak_id
)
}

}
