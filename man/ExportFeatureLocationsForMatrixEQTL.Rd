% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ExportFeatureLocationsForMatrixEQTL.R
\name{ExportFeatureLocationsForMatrixEQTL}
\alias{ExportFeatureLocationsForMatrixEQTL}
\title{Export gene feature locations for Matrix eQTL analysis}
\usage{
ExportFeatureLocationsForMatrixEQTL(
  gtf_file,
  genes,
  output_dir = ".",
  use_gene_name = TRUE,
  add_chr_prefix = FALSE,
  filename = "feature_locations.txt"
)
}
\arguments{
\item{gtf_file}{Path to a GTF file containing gene annotations.}

\item{genes}{A Seurat object, a \code{SummarizedExperiment} object, or a character vector of gene identifiers.}

\item{output_dir}{Directory where the output file will be saved. Defaults to the current directory.}

\item{use_gene_name}{Logical. If \code{TRUE}, match genes by \code{gene_name} first, falling back to \code{gene_id}.
If \code{FALSE}, match only by \code{gene_id}.}

\item{add_chr_prefix}{Logical. If \code{TRUE}, adds \code{"chr"} prefix to chromosome names (e.g., \code{1} -> \code{chr1}).}

\item{filename}{Name of the output file. Defaults to \code{"feature_locations.txt"}.}
}
\value{
(Invisibly) the path to the output file containing the feature locations.
}
\description{
This function extracts and formats genomic feature location data from a GTF file for a specified set of genes,
and writes it in a format compatible with Matrix eQTL. It supports gene identifiers from Seurat objects,
\code{SummarizedExperiment}s, or character vectors.
}
\details{
The function filters GTF entries to keep only those of type \code{"gene"}, and retrieves
their chromosome, start, and end coordinates. If gene identifiers are duplicated between
\code{gene_name} and \code{gene_id}, matches by \code{gene_name} are prioritized.
}
\examples{
\dontrun{
ExportFeatureLocationsForMatrixEQTL(
  gtf_file = "annotation.gtf",
  genes = c("GeneA", "GeneB", "GeneC"),
  output_dir = "eqtl_files",
  use_gene_name = TRUE,
  add_chr_prefix = TRUE
)
}

}
\seealso{
\code{\link{convert_chromosome_ids}} for chromosome name formatting
}
