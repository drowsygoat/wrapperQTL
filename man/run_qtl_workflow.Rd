% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/run_qtl_workflow.R
\name{run_qtl_workflow}
\alias{run_qtl_workflow}
\title{Run the QTL post-processing workflow (+ optional nearest-gene annotation)}
\usage{
run_qtl_workflow(
  results,
  vcf_file,
  apply_peak_range = TRUE,
  peak_params = list(METHOD = "DistanceFromPeak", SIGTHRESHOLD = 0.01, SEARCHDISTANCE =
    3e+06, LOCALPEAKTHRESHOLD = 0.01, MINGAPSIZE = 0),
  recalc_fdr = TRUE,
  annotate_peaks = FALSE,
  se = NULL,
  key_col = "peak_id",
  nearest_genes = FALSE,
  gtf_file = NULL,
  nearest_on = c("peak", "snp"),
  nearest_output = c("both", "gene", "distance"),
  tss_gr = NULL,
  output_dir = ".",
  prefix = "qtl",
  write_outputs = FALSE
)
}
\arguments{
\item{results}{QTL results data.frame/tibble with columns:
\code{p_value}, \code{chr_snp}, \code{location_snp}, \code{peak_id}, \code{QTL_type}
(and optionally \code{FDR}).}

\item{vcf_file}{Path to VCF used to filter SNPs (via \code{read_chr_pos_from_vcf}).}

\item{apply_peak_range}{Logical; run \code{peak_range()} per cis/trans and join back. Default TRUE.}

\item{peak_params}{List of params passed to \code{peak_range()}.
Default: \code{list(METHOD="DistanceFromPeak", SIGTHRESHOLD=0.01, SEARCHDISTANCE=3e6, LOCALPEAKTHRESHOLD=0.01, MINGAPSIZE=0)}.}

\item{recalc_fdr}{Logical; if TRUE, add \code{FDR_recal := p.adjust(p_value,"BH")}. Default TRUE.}

\item{annotate_peaks}{Logical; if TRUE, call \code{annotate_with_rowdata_peaks()} on cis/trans. Default FALSE.}

\item{se}{SummarizedExperiment for \code{annotate_with_rowdata_peaks()} (required if \code{annotate_peaks=TRUE}).}

\item{key_col}{Peak ID column in \code{results} for annotation. Default "peak_id".}

\item{nearest_genes}{Logical; if TRUE, annotate nearest gene by TSS from a GTF. Default FALSE.}

\item{gtf_file}{Path to GTF (plain or .gz). Required if \code{nearest_genes=TRUE} and \code{tss_gr} is NULL.}

\item{nearest_on}{Compute nearest gene relative to \code{"peak"} (columns \code{chr, location}) or \code{"snp"} (\code{chr_snp, location_snp}). Default "peak".}

\item{nearest_output}{What to add: \code{"gene"}, \code{"distance"}, or \code{"both"}. Default "both".}

\item{tss_gr}{Optional precomputed TSS GRanges (from \code{nearest_gene_from_gtf_build_tss()}) to speed up repeated calls.}

\item{output_dir}{Directory for outputs when \code{write_outputs=TRUE}. Default ".".}

\item{prefix}{Filename prefix for outputs. Default "qtl".}

\item{write_outputs}{Logical; write CSVs and PDFs. Default FALSE.}
}
\value{
List:
\itemize{
\item \code{filtered} – VCF-filtered results.
\item \code{peak_counts} – counts per QTL_type.
\item \code{cis_ranges}, \code{trans_ranges} – outputs from \code{peak_range()} (if used).
\item \code{cis}, \code{trans} – final tables (with optional FDR recalculation, rowData & nearest gene annotations).
\item \code{plot_files} – written plot paths (if any).
\item \code{tss} – the TSS GRanges used (if nearest_genes=TRUE).
}
}
\description{
Run the QTL post-processing workflow (+ optional nearest-gene annotation)
}
