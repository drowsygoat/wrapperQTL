% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/manhattan_plot_gg.R
\name{manhattan_plot_gg}
\alias{manhattan_plot_gg}
\title{Manhattan Plot with Optional Region Highlighting}
\usage{
manhattan_plot_gg(
  df,
  chr_col = "chr",
  pos_col = "location",
  p_col = "FDR_recal",
  region_start_col = "RegionStart",
  region_end_col = "RegionEnd",
  sig.level = NA,
  show_regions = TRUE,
  region_alpha = 0.1,
  col = c("gray40", "gray60"),
  point_size = 1
)
}
\arguments{
\item{df}{A data.frame containing chromosome, position, and p-value columns.}

\item{chr_col}{Column name (string) for chromosome identifiers. Default \code{"Chromosome"}.}

\item{pos_col}{Column name (string) for genomic position (bp or Mb). Default \code{"PeakPosition"}.}

\item{p_col}{Column name (string) for p-values. Default \code{"PeakPvalue"}.}

\item{region_start_col}{Column name (string) for region start (bp or Mb). Default \code{"RegionStart"}.}

\item{region_end_col}{Column name (string) for region end (bp or Mb). Default \code{"RegionEnd"}.}

\item{sig.level}{Numeric p-value threshold for a dashed horizontal line (e.g., \code{5e-8}).
Use \code{NA} (default) to omit the line.}

\item{show_regions}{Logical; if \code{TRUE} (default) and both region columns are present
in \code{df}, shaded rectangles are drawn over those regions.}

\item{region_alpha}{Alpha for region shading (0-1). Default \code{0.1}.}

\item{col}{Two-color vector used to alternate chromosome point colors. Default
\code{c("gray40","gray60")}.}

\item{point_size}{Point size for scatter layer. Default \code{1}.}
}
\value{
A \code{ggplot} object.
}
\description{
Creates a Manhattan-style plot from a data frame using \pkg{ggplot2}, with optional
highlighted genomic regions. Chromosome labels are naturally ordered (via
\code{gtools::mixedsort}), basepair positions are auto-scaled to Mb when values look
like basepairs, and a horizontal significance line can be added.
}
\details{
If region columns are not present (or \code{show_regions = FALSE}), the plot is drawn
without any highlighted rectangles.

The function:
\enumerate{
\item Strips a leading \code{"chr"} from chromosome labels and orders chromosomes
using natural sort.
\item Converts positions to megabases if any positions exceed 1e6.
\item Computes cumulative genomic positions to lay chromosomes end-to-end.
\item Alternates point colors by chromosome.
\item Optionally shades regions if \code{show_regions = TRUE} and both region columns
exist in \code{df}. If region columns are missing, the plot is drawn without regions.
}
}
\examples{
\dontrun{
df <- data.frame(
  Chromosome = rep(paste0("chr", 1:3), each = 100),
  PeakPosition = rep(seq(1, 5e6, length.out = 100), 3),
  PeakPvalue = runif(300)
)
p <- manhattan_plot_gg(df, sig.level = 5e-8)
print(p)
}

}
