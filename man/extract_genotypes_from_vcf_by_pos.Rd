% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/extract_genotypes_from_vcf_by_pos.R
\name{extract_genotypes_from_vcf_by_pos}
\alias{extract_genotypes_from_vcf_by_pos}
\title{Extract Genotypes from VCF by Chromosome and Position}
\usage{
extract_genotypes_from_vcf_by_pos(
  vcf_path,
  snp_df,
  chr_col = "CHR",
  pos_col = "POS",
  Capitalize = TRUE,
  pattern = NULL
)
}
\arguments{
\item{vcf_path}{Path to the VCF file (can be gzipped or plain text).}

\item{snp_df}{A data frame containing SNP positions to extract. Must include chromosome and position columns.}

\item{chr_col}{Name of the column in \code{snp_df} that contains chromosome identifiers. Default is \code{"CHR"}.}

\item{pos_col}{Name of the column in \code{snp_df} that contains position values. Default is \code{"POS"}.}

\item{Capitalize}{Logical; whether to capitalize cleaned sample names. Default is \code{TRUE}.}

\item{pattern}{Optional integer vector specifying which parts of sample names (split by "_") to retain. Used for sample name cleaning.}
}
\value{
A data frame of genotypes with SNP IDs as rows and cleaned sample names as columns. Genotypes are in unphased format (e.g., \code{A/T}, \code{G/G}).
}
\description{
Extracts genotype data for specific SNP positions from a VCF file and formats genotypes as unphased allele pairs (e.g., \code{A/G}, \code{C/C}).
}
\details{
This function:
\itemize{
\item Extracts VCF lines corresponding to provided chromosome-position pairs.
\item Parses genotype fields (\code{GT}) and maps 0/1 alleles to REF/ALT bases.
\item Cleans sample names using the provided \code{pattern} or automatic heuristics.
}

SNPs are identified by combining chromosome, position, and ALT allele (\code{CHR:POS_ALT}). Lines without valid genotypes are returned as \code{NA}.
}
\examples{
\dontrun{
snp_df <- data.frame(CHR = c("1", "2"), POS = c("12345", "67890"))
vcf_file <- "variants.vcf.gz"
genotypes <- extract_genotypes_from_vcf_by_pos(vcf_file, snp_df)
}

}
